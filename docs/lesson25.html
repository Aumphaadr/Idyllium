<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Урок 23: Работа с файлами — Idyllium</title>
    <link rel="stylesheet" href="./fonts/fonts.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="shortcut icon" href="./img/favicon.png" type="image/x-icon">
</head>
<body>
    <header id="shared-header"></header>
    <main>
        <section>
            <h1>Урок 23: Работа с файлами</h1>
            <p class="subtitle">Как сохранять данные между запусками программы и загружать то, что уже было записано</p>
        </section>
        <section class="flex">
            <div id="lessons-nav-placeholder"></div>
            <div class="examples">
                <div class="example">
                    <h2>Зачем нужны файлы?</h2>
                    <p>До сих пор всё, что делала ваша программа, исчезало после её завершения. Чтобы сохранить данные надолго — их нужно записать в файл.</p>
                    <p>Файлы позволяют:</p>
                    <ul>
                        <li>Сохранять результаты работы (например, таблицу рекордов);</li>
                        <li>Загружать настройки или уровень игры;</li>
                        <li>Обмениваться данными между программами.</li>
                    </ul>
                </div>
                <div class="example">
                    <h2>Библиотека <code>file</code></h2>
                    <p>Для работы с файлами в Idyllium используется встроенная библиотека <code>file</code>:</p>
                    <pre><span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span></pre>
                    <p>Она предоставляет два типа потоков:</p>
                    <ul>
                        <li><code>file.ostream</code> — для записи в файл (<em>output stream</em>);</li>
                        <li><code>file.istream</code> — для чтения из файла (<em>input stream</em>).</li>
                    </ul>
                </div>
                <div class="example">
                    <h2>Запись в файл: пошагово</h2>
                    <p>Чтобы записать данные в файл, нужно:</p>
                    <ol>
                        <li>Открыть файл для записи;</li>
                        <li>Записать нужные строки;</li>
                        <li>Обязательно закрыть файл.</li>
                    </ol>
                    <pre><span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span>

<span class="function">main</span><span class="brackets">()</span> <span class="brackets">{</span>
    <span class="comment">// 1. Открываем файл "output.txt" для записи</span>
    <span class="object">file</span><span class="brackets">.</span><span class="typeName">ostream</span> <span class="object">fout</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"output.txt"</span><span class="brackets">,</span> <span class="string">"write"</span><span class="brackets">);</span>

    <span class="comment">// 2. Записываем данные</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Привет, мир!"</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Сейчас "</span><span class="brackets">,</span> <span class="number">2025</span><span class="brackets">,</span> <span class="string">" год"</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Файл создан с помощью Idyllium!"</span><span class="brackets">);</span>

    <span class="comment">// 3. Обязательно закрываем файл</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span>
<span class="brackets">}</span></pre>
                    <p>После выполнения программы в той же папке появится файл <code>output.txt</code> с указанным содержимым.</p>
                </div>
                <div class="example">
                    <h2>Чтение из файла: пошагово</h2>
                    <p>Чтение происходит в обратном порядке:</p>
                    <ol>
                        <li>Открыть файл для чтения;</li>
                        <li>Пока есть строки — читать их по одной;</li>
                        <li>Закрыть файл.</li>
                    </ol>
                    <pre><span class="keyword">use</span> <span class="object">console</span><span class="brackets">;</span>
<span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span>

<span class="function">main</span><span class="brackets">()</span> <span class="brackets">{</span>
    <span class="comment">// 1. Открываем файл "input.txt" для чтения</span>
    <span class="object">file</span><span class="brackets">.</span><span class="typeName">istream</span> <span class="object">fin</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"input.txt"</span><span class="brackets">,</span> <span class="string">"read"</span><span class="brackets">);</span>

    <span class="comment">// 2. Пока в файле есть строки — читаем их</span>
    <span class="keyword">while</span> <span class="brackets">(</span><span class="object">fin</span><span class="brackets">.</span><span class="function">has_next_line</span><span class="brackets">())</span>
    <span class="brackets">{</span>
        <span class="typeName">string</span> <span class="object">one_line</span> <span class="brackets">=</span> <span class="object">fin</span><span class="brackets">.</span><span class="function">read_line</span><span class="brackets">();</span>
        <span class="comment">// убираем управляющие символы (например, '\n')</span>
        <span class="typeName">string</span> <span class="object">fixed_line</span> <span class="brackets">=</span> <span class="object">one_line</span><span class="brackets">.</span><span class="function">simplify</span><span class="brackets">();</span>
        <span class="object">console</span><span class="brackets">.</span><span class="function">write</span><span class="brackets">(</span><span class="object">fixed_line</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="brackets">}</span>

    <span class="comment">// 3. Обязательно закрываем файл</span>
    <span class="object">fin</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span>
<span class="brackets">}</span></pre>
                    <p>Метод <code>.simplify()</code> удаляет из строки управляющие последовательности, такие как <code>\n</code>, <code>\r</code>, и делает вывод чище.</p>
                </div>
                <div class="example">
                    <h2>Важные правила</h2>
                    <ul>
                        <li><strong>Всегда закрывайте файл</strong> с помощью <code>.close()</code>. Иначе данные могут не сохраниться.</li>
                        <li>Файл <code>"output.txt"</code> будет создан автоматически, если его нет.</li>
                        <li>Если попытаться прочитать несуществующий файл — программа завершится с ошибкой.</li>
                        <li>Имена файлов чувствительны к регистру и расширению: <code>data.txt</code> ≠ <code>Data.TXT</code>.</li>
                    </ul>
                </div>
                <div class="example">
                    <h2>Практическая задача: логгер</h2>
                    <p>Создадим простую программу, которая записывает каждое действие пользователя в лог-файл:</p>
                    <pre><span class="keyword">use</span> <span class="object">console</span><span class="brackets">;</span>
<span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span>

<span class="function">main</span><span class="brackets">()</span> <span class="brackets">{</span>
    <span class="object">file</span><span class="brackets">.</span><span class="typeName">ostream</span> <span class="object">log</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"activity.log"</span><span class="brackets">,</span> <span class="string">"write"</span><span class="brackets">);</span>

    <span class="object">console</span><span class="brackets">.</span><span class="function">write</span><span class="brackets">(</span><span class="string">"Введите ваше имя: "</span><span class="brackets">);</span>
    <span class="typeName">string</span> <span class="object">name</span> <span class="brackets">=</span> <span class="object">console</span><span class="brackets">.</span><span class="function">get_string</span><span class="brackets">();</span>
    <span class="object">log</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Пользователь: "</span><span class="brackets">,</span> <span class="object">name</span><span class="brackets">);</span>

    <span class="object">console</span><span class="brackets">.</span><span class="function">write</span><span class="brackets">(</span><span class="string">"Выберите действие (1 — сохранить, 2 — выйти): "</span><span class="brackets">);</span>
    <span class="typeName">int</span> <span class="object">choice</span> <span class="brackets">=</span> <span class="object">console</span><span class="brackets">.</span><span class="function">get_int</span><span class="brackets">();</span>
    <span class="object">log</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Выбрано действие: "</span><span class="brackets">,</span> <span class="object">choice</span><span class="brackets">);</span>

    <span class="object">log</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span>
    <span class="object">console</span><span class="brackets">.</span><span class="function">write</span><span class="brackets">(</span><span class="string">"Данные сохранены в activity.log\n"</span><span class="brackets">);</span>
<span class="brackets">}</span></pre>
                    <p>Такой подход используется в реальных программах — от игр до банковских систем.</p>
                </div>
                <div class="example">
                    <h2>Итог</h2>
                    <p>Работа с файлами в Idyllium:</p>
                    <ul>
                        <li>Проста и последовательна;</li>
                        <li>Требует явного открытия и закрытия;</li>
                        <li>Использует понятные методы: <code>open</code>, <code>write_line</code>, <code>read_line</code>, <code>has_next_line</code>, <code>close</code>;</li>
                        <li>Позволяет сохранять и загружать данные без лишней сложности.</li>
                    </ul>
                    <p>Теперь ваши программы могут «помнить» то, что происходило в прошлый раз.</p>
                </div>
                <div class="example">
                    <div class="lesson-nav">
                        <a href="./lesson22.html" class="nav-button nav-prev">
                            ← Урок 22: Создание собственных библиотек
                        </a>
                        <a href="./lesson24.html" class="nav-button nav-next">
                            Урок 24: Продвинутые функции math →
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p class="subtitle">Maintaining just for lulz</p>
        <div style="text-align: center;"><span class="copyright">©</span>2025-∞</div>
    </footer>
    <script src="./common.js" defer></script>
</body>
</html>