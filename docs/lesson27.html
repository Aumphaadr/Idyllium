<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Урок 23: Работа с файлами — Idyllium</title>
    <link rel="stylesheet" href="./fonts/fonts.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="shortcut icon" href="./img/favicon.png" type="image/x-icon">
    <style>
        div.file {
            background-color: #2d2d2d;
            color: #d4d4d4;
            padding: 1em;
            border-left: 4px solid #7a5a99;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.95em;
            line-height: 1.4;
            border-radius: 0.3em;
            overflow-x: auto;
            margin: 1em 0;
        }
    </style>
</head>
<body>
    <header id="shared-header"></header>
    <main>
        <section>
            <h1>Урок 23: Работа с файлами</h1>
            <p class="subtitle">Как сохранять данные между запусками программы и читать их обратно</p>
        </section>
        <section class="flex">
            <div id="lessons-nav-placeholder"></div>
            <div class="examples">
                <div class="example">
                    <h2>Зачем нужны файлы?</h2>
                    <p>Консоль — временный инструмент. Весь вывод исчезает после завершения программы.</p>
                    <p>Файлы позволяют:</p>
                    <ul>
                        <li>Сохранять результаты работы программы;</li>
                        <li>Читать данные, подготовленные заранее;</li>
                        <li>Обмениваться информацией между программами.</li>
                    </ul>
                    <p>В Idyllium для работы с файлами используется библиотека <code>file</code>.</p>
                </div>
                <div class="example">
                    <h2>Запись данных в файл</h2>
                    <p>Чтобы записать текст в файл, нужно:</p>
                    <ol>
                        <li>Открыть файл в режиме <code>"write"</code>;</li>
                        <li>Записать в него строки;</li>
                        <li>Закрыть файл.</li>
                    </ol>
                    <pre><span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span>

<span class="function">main</span><span class="brackets">()</span> <span class="brackets">{</span>
    <span class="object">file</span><span class="brackets">.</span><span class="typeName">ostream</span> <span class="object">fout</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"output.txt"</span><span class="brackets">,</span> <span class="string">"write"</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Привет, мир!"</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Сейчас "</span><span class="brackets">,</span> <span class="number">2025</span><span class="brackets">,</span> <span class="string">" год"</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Файл создан с помощью Idyllium!"</span><span class="brackets">);</span>
    <span class="object">fout</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span>
<span class="brackets">}</span></pre>
                    <p>После выполнения программы в папке появится файл <code>output.txt</code> со следующим содержимым:</p>
                    <div class="file">Привет, мир!
Сейчас 2025 год
Файл создан с помощью Idyllium!</div>
                    <p>Метод <code>write_line()</code> записывает строку и не добавляет символ новой строки автоматически — вы управляете форматом сами.</p>
                </div>
                <div class="example">
                    <h2>Чтение данных из файла</h2>
                    <p>Чтобы прочитать текст из файла, нужно:</p>
                    <ol>
                        <li>Открыть файл в режиме <code>"read"</code>;</li>
                        <li>Пока в файле есть строки — читать их по одной;</li>
                        <li>Закрыть файл.</li>
                    </ol>
                    <pre><span class="keyword">use</span> <span class="object">console</span><span class="brackets">;</span>
<span class="keyword">use</span> <span class="object">file</span><span class="brackets">;</span>

<span class="function">main</span><span class="brackets">()</span> <span class="brackets">{</span>
    <span class="object">file</span><span class="brackets">.</span><span class="typeName">istream</span> <span class="object">fin</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"input.txt"</span><span class="brackets">,</span> <span class="string">"read"</span><span class="brackets">);</span>
    <span class="keyword">while</span> <span class="brackets">(</span><span class="object">fin</span><span class="brackets">.</span><span class="function">has_next_line</span><span class="brackets">())</span>
    <span class="brackets">{</span>
        <span class="typeName">string</span> <span class="object">one_line</span> <span class="brackets">=</span> <span class="object">fin</span><span class="brackets">.</span><span class="function">read_line</span><span class="brackets">();</span>
        <span class="typeName">string</span> <span class="object">fixed_line</span> <span class="brackets">=</span> <span class="object">one_line</span><span class="brackets">.</span><span class="function">simplify</span><span class="brackets">();</span> <span class="comment">// убирает '\n' и другие управляющие символы</span>
        <span class="object">console</span><span class="brackets">.</span><span class="function">write</span><span class="brackets">(</span><span class="object">fixed_line</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
    <span class="brackets">}</span>
    <span class="object">fin</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span>
<span class="brackets">}</span></pre>
                    <p>Предположим, что файл <code>input.txt</code> содержит:</p>
                    <div class="file">Кошка спит на подоконнике.
Собака лает во дворе.
Черепаха медленно ползёт.</div>
                    <p>Тогда программа выведет в консоль:</p>
                    <div class="output">Кошка спит на подоконнике.
Собака лает во дворе.
Черепаха медленно ползёт.</div>
                </div>
                <div class="example">
                    <h2>Ключевые компоненты</h2>
                    <p><strong>Типы потоков:</strong></p>
                    <ul>
                        <li><code>file.ostream</code> — поток для <em>записи</em> (output stream);</li>
                        <li><code>file.istream</code> — поток для <em>чтения</em> (input stream).</li>
                    </ul>
                    <p><strong>Функции и методы:</strong></p>
                    <ul>
                        <li><code>file.open("имя.txt", "режим")</code> — открывает файл;</li>
                        <li><code>write_line(...)</code> — записывает строку (можно передавать несколько аргументов, как в <code>console.write</code>);</li>
                        <li><code>read_line()</code> — читает одну строку целиком;</li>
                        <li><code>has_next_line()</code> — проверяет, есть ли ещё строки в файле;</li>
                        <li><code>simplify()</code> — очищает строку от управляющих символов (например, <code>\n</code> в конце);</li>
                        <li><code>close()</code> — закрывает файл и освобождает ресурсы.</li>
                    </ul>
                    <p>Закрывать файл — обязательно. Иначе изменения могут не сохраниться.</p>
                </div>
                <div class="example">
                    <h2>Практическое применение</h2>
                    <p>Файлы позволяют, например, сохранить результаты игры:</p>
                    <pre><span class="object">file</span><span class="brackets">.</span><span class="typeName">ostream</span> <span class="object">save</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"save.txt"</span><span class="brackets">,</span> <span class="string">"write"</span><span class="brackets">);</span>
<span class="object">save</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Игрок: "</span><span class="brackets">,</span> <span class="object">name</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
<span class="object">save</span><span class="brackets">.</span><span class="function">write_line</span><span class="brackets">(</span><span class="string">"Очки: "</span><span class="brackets">,</span> <span class="object">score</span><span class="brackets">,</span> <span class="string">'\n'</span><span class="brackets">);</span>
<span class="object">save</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span></pre>
                    <p>Или загрузить словарь слов для викторины:</p>
                    <pre><span class="object">file</span><span class="brackets">.</span><span class="typeName">istream</span> <span class="object">dict</span> <span class="brackets">=</span> <span class="object">file</span><span class="brackets">.</span><span class="function">open</span><span class="brackets">(</span><span class="string">"words.txt"</span><span class="brackets">,</span> <span class="string">"read"</span><span class="brackets">);</span>
<span class="typeName">dyn_array</span><span class="brackets">&lt;</span><span class="typeName">string</span><span class="brackets">&gt;</span> <span class="object">words</span><span class="brackets">;</span>
<span class="keyword">while</span> <span class="brackets">(</span><span class="object">dict</span><span class="brackets">.</span><span class="function">has_next_line</span><span class="brackets">())</span> <span class="brackets">{</span>
    <span class="object">words</span><span class="brackets">.</span><span class="function">add</span><span class="brackets">(</span><span class="object">dict</span><span class="brackets">.</span><span class="function">read_line</span><span class="brackets">().</span><span class="function">simplify</span><span class="brackets">());</span>
<span class="brackets">}</span>
<span class="object">dict</span><span class="brackets">.</span><span class="function">close</span><span class="brackets">();</span></pre>
                    <p>Теперь ваша программа может работать с данными, которые вы не вводите вручную каждый раз.</p>
                </div>
                <div class="example">
                    <div class="lesson-nav">
                        <a href="./lesson22.html" class="nav-button nav-prev">
                            ← Урок 22: Создание собственных библиотек
                        </a>
                        <a href="./lesson24.html" class="nav-button nav-next">
                            Урок 24: Продвинутые функции math →
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p class="subtitle">Maintaining just for lulz</p>
        <div style="text-align: center;"><span class="copyright">©</span>2025-∞</div>
    </footer>
    <script src="./common.js" defer></script>
</body>
</html>